{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"52370866-f56fe6e7c04694f1b916d2ffa\"; // твій ключ\nconst BASE_URL = \"https://pixabay.com/api/\";\nexport const PER_PAGE = 15;\n\nexport async function getImagesByQuery(query, page = 1) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    per_page: PER_PAGE,\n    page,\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data; // => { hits, totalHits }\n  } catch (error) {\n    throw new Error(\"Error fetching images: \" + error.message);\n  }\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\nconst loader = document.querySelector(\".loader\");\n\nlet lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nexport function clearGallery() {\n  gallery.innerHTML = \"\";\n  lightbox.refresh();\n}\n\nexport function createGallery(images) {\n  const markup = images.map(img => `\n    <li class=\"gallery-item\">\n      <a href=\"${img.largeImageURL}\">\n        <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" />\n      </a>\n      <div class=\"info\">\n        <p><span>Likes</span>${img.likes}</p>\n        <p><span>Views</span>${img.views}</p>\n        <p><span>Comments</span>${img.comments}</p>\n        <p><span>Downloads</span>${img.downloads}</p>\n      </div>\n    </li>\n  `).join(\"\");\n\n  gallery.insertAdjacentHTML(\"beforeend\", markup);\n  lightbox.refresh();\n}\n\nexport function showLoader() {\n  loader.style.display = \"block\";  \n}\nexport function hideLoader() {\n  loader.style.display = \"none\"; \n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.style.display = \"inline-block\";\n}\nexport function hideLoadMoreButton() {\n  loadMoreBtn.style.display = \"none\";\n}\n\nexport function getFirstCardHeight() {\n  const firstCard = gallery.querySelector(\".gallery-item\");\n  return firstCard ? firstCard.getBoundingClientRect().height : 0;\n}","import { getImagesByQuery, PER_PAGE } from \"./js/pixabay-api\";\nimport { \n  createGallery, \n  clearGallery, \n  showLoader, \n  hideLoader, \n  showLoadMoreButton, \n  hideLoadMoreButton,\n  getFirstCardHeight \n} from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst form = document.querySelector(\".form\");\nconst input = form.querySelector('input[name=\"search-text\"]');\nconst loadMoreBtn = document.querySelector(\".load-more\");\n\nlet currentQuery = \"\";\nlet currentPage = 1;\nlet totalHits = 0;\nlet loadedImagesCount = 0;\n\nhideLoadMoreButton();\n\nform.addEventListener(\"submit\", async (e) => {\n  e.preventDefault();\n\n  const query = input.value.trim();\n  if (!query) {\n    iziToast.error({ \n      message: \"Please enter a search term!\", \n      position: \"topRight\",\n      class: \"custom-toast custom-error\"  \n    });\n    return;\n  }\n\n  if (query !== currentQuery) {\n    currentQuery = query;\n    currentPage = 1;\n    totalHits = 0;\n    loadedImagesCount = 0;\n    clearGallery();\n    hideLoadMoreButton();\n  }\n\n  await fetchAndRender({ initial: true });\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  currentPage += 1;\n  await fetchAndRender({ smoothScroll: true });\n});\n\nasync function fetchAndRender({ initial = false, smoothScroll = false } = {}) {\n  try {\n    showLoader();\n    const data = await getImagesByQuery(currentQuery, currentPage);\n    const { hits, totalHits: serverTotalHits } = data;\n\n    if (currentPage === 1 && hits.length === 0) {\n      hideLoader();\n      iziToast.warning({\n        message: \"Sorry, no images found!\",\n        position: \"topRight\",\n        class: \"custom-toast custom-warning\"\n      });\n      return;\n    }\n\n    createGallery(hits);\n    totalHits = serverTotalHits;\n    loadedImagesCount += hits.length;\n\n    if (loadedImagesCount >= totalHits) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n\n    if (smoothScroll) {\n      const cardHeight = getFirstCardHeight();\n      if (cardHeight > 0) {\n        window.scrollBy({ top: cardHeight * 2, behavior: \"smooth\" });\n      }\n    }\n\n    if (initial) {\n      iziToast.success({\n        message: `Found ${totalHits} images for \"${currentQuery}\"`,\n        position: \"topRight\"\n      });\n    }\n\n  } catch (error) {\n    iziToast.error({\n      message: \"Something went wrong. Try again later.\",\n      position: \"topRight\",\n      class: \"custom-toast custom-error\"\n    });\n  } finally {\n    hideLoader(); \n  }\n}\n"],"names":["API_KEY","BASE_URL","PER_PAGE","getImagesByQuery","query","page","params","axios","error","gallery","loadMoreBtn","loader","lightbox","SimpleLightbox","clearGallery","createGallery","images","markup","img","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","getFirstCardHeight","firstCard","form","input","currentQuery","currentPage","totalHits","loadedImagesCount","e","iziToast","fetchAndRender","initial","smoothScroll","data","hits","serverTotalHits","cardHeight"],"mappings":"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"}